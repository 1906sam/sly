(function(i,B){function Q(w,a){function q(b,v,e){e=F(e)?e:a.speed;v&&o&&(v=R(b),E?(b=j[v.centerItem].offCenter,h[z?"activate":"toCenter"](v.centerItem,1)):b>d.min&&b<d.max&&(b=j[v.firstItem].offStart));if(!A||!a.elasticBounds)b=b<d.min?d.min:b,b=b>d.max?d.max:b;b!==d.cur&&(d.cur=b,i.extend(c,R(d.cur)),S(),T(),!A&&r.trigger(t+":move",[d,m,c]),b=a.horizontal?{left:-d.cur+"px"}:{top:-d.cur+"px"},10<e?f.animate(b,e,A?"swing":a.easing,function(){!A&&r.trigger(t+":moveEnd",[d,m,c])}):(f.css(b),!A&&r.trigger(t+
":moveEnd",[d,m,c])))}function x(b){p&&(g.cur=Math.round((d.cur-d.min)/(d.max-d.min)*g.max),g.cur=g.cur<g.min?g.min:g.cur>g.max?g.max:g.cur,p.stop().animate(a.horizontal?{left:g.cur+"px"}:{top:g.cur+"px"},F(b)?b:a.speed,a.easing));V()}function V(){M.length&&M.removeClass(a.activeClass).eq(c.activePage).addClass(a.activeClass)}function T(){f.add(p).stop()}function y(b){return F(b)?0>b?0:b>j.length-1?j.length-1:b:b===B?-1:m.index(b)}function C(b,a){return parseInt(b.css(a),10)}function R(b){for(var a=
{},e=z?0:s/2,c=0;c<k.length;c++){if(b>=d.max||c===k.length-1){a.activePage=k.length-1;break}if(b<=k[c]+e){a.activePage=c;break}}if(o){for(var g=c=e=!1,f=0;f<j.length;f++){!1===e&&b<=j[f].offStart&&(e=f);!1===g&&b-j[f].size/2<=j[f].offCenter&&(g=f);if(f===j.length-1||!1===c&&b<j[f+1].offEnd)c=f;if(!1!==c)break}a.firstItem=F(e)?e:0;a.centerItem=F(g)?g:a.firstItem;a.lastItem=F(c)?c:a.centerItem}return a}function S(){if(o){var b=0===c.activeItem,v=c.activeItem>=j.length-1;G.is("button,input")&&G.prop("disabled",
b);H.is("button,input")&&H.prop("disabled",v);G[b?"removeClass":"addClass"](a.disabledClass);H[v?"removeClass":"addClass"](a.disabledClass)}M.length&&(b=d.cur<=d.min,v=d.cur>=d.max,N.is("button,input")&&N.prop("disabled",b),O.is("button,input")&&O.prop("disabled",v),N[b?"removeClass":"addClass"](a.disabledClass),O[v?"removeClass":"addClass"](a.disabledClass))}function u(b,a){var e=b||window.event;e.preventDefault?e.preventDefault():e.returnValue=!1;a&&e.stopPropagation?e.stopPropagation():e.cancelBubble=
!0}function F(a){return!isNaN(parseFloat(a))&&isFinite(a)}var h=this,r=i(w),f=r.children().eq(0),s=0,l=0,d={cur:0,max:0,min:0},I=i(a.scrollBar),p=I.length?I.children().eq(0):0,J=0,D=0,g={cur:0,max:0,min:0},U=i(a.pagesBar),M=0,k=[],W="smart"===a.itemNav,z="forceCentered"===a.itemNav,E="centered"===a.itemNav||z,o="basic"===a.itemNav||W||E||z,m=0,j=[],c={firstItem:0,lastItem:1,centerItem:1,activeItem:-1,activePage:0,items:0,pages:0},X=a.scrollSource?i(a.scrollSource):r,G=i(a.prev),H=i(a.next),N=i(a.prevPage),
O=i(a.nextPage),K=0,Y=0,A=0,Q=this.reload=function(){var b=0;clearTimeout(K);s=a.horizontal?r.width():r.height();J=a.horizontal?I.width():I.height();l=a.horizontal?f.outerWidth():f.outerHeight();m=f.children();j=[];k=[];d.min=0;d.max=l>s?l-s:0;c.items=m.length;if(o){var v=C(m,a.horizontal?"marginLeft":"marginTop"),e=C(m.slice(-1),a.horizontal?"marginRight":"marginBottom"),P=0,u=C(f,a.horizontal?"paddingLeft":"paddingTop"),w=C(f,a.horizontal?"paddingRight":"paddingBottom"),y="none"!==m.css("float"),
b=v?0:e;l=0;m.each(function(b,e){var d=i(e),c=a.horizontal?d.outerWidth(!0):d.outerHeight(!0),f=C(d,"marginTop"),g=C(d,"marginBottom"),h=C(d,"marginLeft"),d=C(d,"marginRight"),h={size:c,offStart:l-(!b||a.horizontal?0:f),offCenter:l-Math.round(s/2-c/2),offEnd:l-s+c-(v?0:d),margins:{top:f,bottom:g,left:h,right:d}};b||(P=-(z?Math.round(s/2-c/2):0)+u,l+=u);l+=c;!a.horizontal&&!y&&g&&f&&0<b&&(l-=f<g?f:g);b===m.length-1&&(l+=w);j.push(h)});f.css(a.horizontal?{width:l+"px"}:{height:l+"px"});l-=b;d.min=P;
d.max=z?j[j.length-1].offCenter:l>s?l-s:0;c.activeItem>=j.length&&h.activate(j.length-1)}i.extend(c,R(d.cur));p&&(D=a.dynamicHandle?Math.round(J*s/l):a.horizontal?p.width():p.height(),D=D>J?J:D,g.max=J-D,p.css(a.horizontal?{width:D+"px"}:{height:D+"px"}));var L=0,e="",aa=0;if(z)k=i.map(j,function(a){return a.offCenter});else for(;L-s<d.max;){var Z=L>d.max?d.max:L;k.push(Z);L+=s;if(L>d.max&&o&&d.max-Z<(j[j.length-1].size-b)/2){k[k.length-1]=d.max;break}}if(U.length){for(b=0;b<k.length;b++)e+=a.pageBuilder(aa++);
M=i(e).bind("click."+n,function(){h.activatePage(M.index(this))}).appendTo(U.empty())}m.unbind("."+n).bind("mouseup."+n,function(a){a.which===1&&!A&&h.activate(this)});d.cur<d.min&&q(d.min);d.cur>d.max&&q(d.max);c.pages=k.length;c.slideeSize=l;c.frameSize=s;c.sbSize=J;c.handleSize=D;x(0);S();o&&a.cycleBy&&(e="mouseenter."+n+" mouseleave."+n,a.pauseOnHover&&r.unbind(e).bind(e,function(a){!Y&&h.cycle(a.type==="mouseenter",1)}),h.cycle(a.startPaused));r.trigger(t+":load",[d,m,c])};this.prev=function(){h.activate(c.activeItem-
1)};this.next=function(){h.activate(c.activeItem+1)};this.prevPage=function(){h.activatePage(c.activePage-1)};this.nextPage=function(){h.activatePage(c.activePage+1)};this.toStart=function(b){if(o){var c=y(b);if(b===B)q(d.min,1);else if(-1!==c){if(E)return;-1!==c&&q(j[c].offStart)}}else b===B?q(d.min):(b=f.find(b).eq(0),b.length&&(b=a.horizontal?b.offset().left-f.offset().left:b.offset().top-f.offset().top,q(b)));x()};this.toEnd=function(b){if(o){var c=y(b);if(b===B)q(d.max,1);else if(-1!==c){if(E)return;
q(j[c].offEnd)}}else b===B?q(d.max):(b=f.find(b).eq(0),b.length&&(c=a.horizontal?b.offset().left-f.offset().left:b.offset().top-f.offset().top,q(c-s+b[a.horizontal?"outerWidth":"outerHeight"]())));x()};this.toCenter=function(b){if(o){var c=y(b);b===B?q(Math.round(d.max/2+d.min/2),1):-1!==c&&(q(j[c].offCenter),z&&h.activate(c,1))}else b===B?q(Math.round(d.max/2)):(b=f.find(b).eq(0),b.length&&(c=a.horizontal?b.offset().left-f.offset().left:b.offset().top-f.offset().top,q(c-s/2+b[a.horizontal?"outerWidth":
"outerHeight"]()/2)));x()};this.activate=function(b,d){if(o&&b!==B){var e=y(b),f=c.activeItem;c.activeItem=e;m.removeClass(a.activeClass).eq(e).addClass(a.activeClass);e!==f&&m.eq(e).trigger(t+":active",[m,c]);d||(E?h.toCenter(e):W&&(e>=c.lastItem?h.toStart(e):e<=c.firstItem&&h.toEnd(e)));S()}};this.activatePage=function(a){a=0>a?0:a>=k.length?k.length-1:a;q(k[a],o);x()};this.cycle=function(b,f){o&&a.cycleBy&&(f||(Y=!!b),b?K&&(K=clearTimeout(K),r.trigger(t+":cyclePause",[d,m,c])):K||(r.trigger(t+
":cycleStart",[d,m,c]),function P(){K=setTimeout(function(){if(!A)switch(a.cycleBy){case "items":h.activate(c.activeItem>=j.length-1?0:c.activeItem+1);break;case "pages":h.activatePage(c.activePage>=k.length-1?0:c.activePage+1)}r.trigger(t+":cycle",[d,m,c]);P()},a.cycleInterval)}()))};this.destroy=function(){r.add(document).add(f).add(m).add(X).add(p).add(G).add(H).add(N).add(O).unbind("."+n);f.add(p).css(a.horizontal?{left:0}:{top:0});G.add(H).removeClass(a.disabledClass);U.empty();i.removeData(w,
n)};(function(){var b=i(document),j="mousemove."+n+" mouseup."+n;"static"===r.css({overflow:"hidden"}).css("position")&&r.css({position:"relative"});"static"===I.css("position")&&I.css({position:"relative"});f.add(p).css(a.horizontal?{position:"absolute",left:0}:{position:"absolute",top:0});Q();o?h.activate(a.startAt):q(a.startAt);x();a.scrollBy&&X.bind("DOMMouseScroll."+n+" mousewheel."+n,function(b){if(d.min!==d.max){u(b,1);var b=b.originalEvent,f=0;b.wheelDelta&&(f=b.wheelDelta/120);b.detail&&
(f=-b.detail/3);b=0>f;o?(b=y((E?z?c.activeItem:c.centerItem:c.firstItem)+(b?a.scrollBy:-a.scrollBy)),h[E?z?"activate":"toCenter":"toStart"](b)):q(d.cur+(b?a.scrollBy:-a.scrollBy));x()}});a.keyboardNav&&b.bind("keydown."+n,function(b){switch(b.keyCode||b.which){case a.horizontal?37:38:u(b);a.keyboardNavByPages?h.prevPage():h.prev();break;case a.horizontal?39:40:u(b),a.keyboardNavByPages?h.nextPage():h.next()}});a.prev&&G.bind("click."+n,function(a){u(a);h.prev()});a.next&&H.bind("click."+n,function(a){u(a);
h.next()});a.prevPage&&N.bind("click."+n,function(a){u(a);h.prevPage()});a.nextPage&&O.bind("click."+n,function(a){u(a);h.nextPage()});a.dragContent&&f.bind("mousedown."+n,function(c){if(1===c.which){u(c);var g=c.clientX,h=c.clientY,l=d.cur,m=+new Date,p=c.target,r=0;f.addClass(a.draggedClass);T();b.bind(j,function(c){var e="mouseup"===c.type,s=a.horizontal?c.clientX-g:c.clientY-h,k=l-s;!r&&10<Math.abs(s)&&(r=1,f.trigger(t+":dragStart",[d]));k>d.max?k=a.elasticBounds?d.max+(k-d.max)/6:d.max:k<d.min&&
(k=a.elasticBounds?d.min+(k-d.min)/6:d.min);if(e){b.unbind(j);f.removeClass(a.draggedClass);var o=+new Date-m,o=300>o?Math.ceil(Math.pow(6/(o/300),2)*Math.abs(s)/120):0,k=k+(0<s?-o:o)}r&&(u(c),p&&(i(p).bind("click."+n,function $(a){u(a,true);i(this).unbind("click."+n,$)}),p=0),A=!e,q(k,e,e?a.speed:0),x(e?null:0),r&&f.trigger(t+":drag",[d]),e&&f.trigger(t+":dragEnd",[d]))})}});p&&a.dragHandle&&p.bind("mousedown."+n,function(c){if(1===c.which){u(c);var f=c.clientX,h=c.clientY,i=g.cur,k=-g.cur,l=g.max-
g.cur,m=0;p.addClass(a.draggedClass);T();b.bind(j,function(c){u(c);var e="mouseup"===c.type,c=a.horizontal?c.clientX-f:c.clientY-h,n=i+c,o=+new Date;A=!e;e&&(b.unbind(j),p.removeClass(a.draggedClass));if(c<l+5&&c>k-5||e){g.cur=n>g.max?g.max:n<g.min?g.min:n;p.stop().css(a.horizontal?{left:g.cur+"px"}:{top:g.cur+"px"});m||p.trigger(t+":dragStart",[g]);p.trigger(t+":drag",[g]);e&&p.trigger(t+":dragEnd",[g]);if(m<=o||e||c>l||c<k)m=o+50,q(Math.round(g.cur/g.max*(d.max-d.min))+d.min,e,e?a.speed:50);V()}})}})})()}
var t="sly",n="plugin_"+t;i.fn[t]=function(w){var a=!1,q=Array.prototype.slice.call(arguments,1),x={};i.isPlainObject(w)?x=i.extend({},i.fn[t].defaults,w):a=!1===w?"destroy":w;return this.each(function(t,w){var y=i.data(w,n)||i.data(w,n,new Q(w,x));i.isFunction(y[a])&&y[a].apply(y,q)})};i.fn[t].defaults={horizontal:0,itemNav:0,scrollBar:null,dynamicHandle:1,dragHandle:1,pagesBar:null,pageBuilder:function(i){return"<li>"+(i+1)+"</li>"},prev:null,next:null,prevPage:null,nextPage:null,cycleBy:0,cycleInterval:5E3,
pauseOnHover:1,startPaused:0,scrollBy:0,dragContent:0,elasticBounds:0,speed:300,easing:"swing",scrollSource:null,startAt:0,keyboardNav:0,keyboardNavByPages:0,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}})(jQuery);
