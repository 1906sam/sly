(function(h,z){function O(t,b){function l(a,i,f){f=G(f)?f:b.speed;i&&v&&(i=P(a),F?(a=j[i.centerItem].offCenter,p[A?"activate":"toCenter"](i.centerItem,1)):a>d.min&&a<d.max&&(a=j[i.firstItem].offStart));if(!B||!b.elasticBounds)a=a<d.min?d.min:a,a=a>d.max?d.max:a;a!==d.cur&&(d.cur=a,h.extend(c,P(d.cur)),Q(),R(),!B&&w.trigger(s+":move",[d,m,c]),a=b.horizontal?{left:-d.cur+"px"}:{top:-d.cur+"px"},10<f?e.animate(a,f,B?"swing":b.easing,function(){!B&&w.trigger(s+":moveEnd",[d,m,c])}):(e.css(a),!B&&w.trigger(s+
":moveEnd",[d,m,c])))}function x(a){q&&(g.cur=Math.round((d.cur-d.min)/(d.max-d.min)*g.max),g.cur=g.cur<g.min?g.min:g.cur>g.max?g.max:g.cur,q.stop().animate(b.horizontal?{left:g.cur+"px"}:{top:g.cur+"px"},G(a)?a:b.speed,b.easing));U()}function U(){L.length&&L.removeClass(b.activeClass).eq(c.activePage).addClass(b.activeClass)}function R(){e.add(q).stop()}function y(a){return G(a)?0>a?0:a>j.length-1?j.length-1:a:a===z?-1:m.index(a)}function C(a,b){return parseInt(a.css(b),10)}function S(a){a=0>a?0:
a>=n.length?n.length-1:a;l(n[a],v);x()}function P(a){for(var b={},f=A?0:r/2,c=0;c<n.length;c++){if(a>=d.max||c===n.length-1){b.activePage=n.length-1;break}if(a<=n[c]+f){b.activePage=c;break}}if(v){for(var g=c=f=!1,e=0;e<j.length;e++){!1===f&&a<=j[e].offStart&&(f=e);!1===g&&a-j[e].size/2<=j[e].offCenter&&(g=e);if(e===j.length-1||!1===c&&a<j[e+1].offEnd)c=e;if(!1!==c)break}b.firstItem=G(f)?f:0;b.centerItem=G(g)?g:b.firstItem;b.lastItem=G(c)?c:b.centerItem}return b}function Q(){if(v){var a=0===c.activeItem,
i=c.activeItem>=j.length-1;H.is("button,input")&&H.prop("disabled",a);I.is("button,input")&&I.prop("disabled",i);H[a?"removeClass":"addClass"](b.disabledClass);I[i?"removeClass":"addClass"](b.disabledClass)}L.length&&(a=d.cur<=d.min,i=d.cur>=d.max,M.is("button,input")&&M.prop("disabled",a),N.is("button,input")&&N.prop("disabled",i),M[a?"removeClass":"addClass"](b.disabledClass),N[i?"removeClass":"addClass"](b.disabledClass))}function u(b,d){var f=b||window.event;f.preventDefault?f.preventDefault():
f.returnValue=!1;d&&f.stopPropagation?f.stopPropagation():f.cancelBubble=!0}function G(b){return!isNaN(parseFloat(b))&&isFinite(b)}var p=this,w=h(t),e=w.children().eq(0),r=0,o=0,d={cur:0,max:0,min:0},J=h(b.scrollBar),q=J.length?J.children().eq(0):0,K=0,D=0,g={cur:0,max:0,min:0},T=h(b.pagesBar),L=0,n=[],V="smart"===b.itemNav,A="forceCentered"===b.itemNav,F="centered"===b.itemNav||A,v="basic"===b.itemNav||V||F||A,m=0,j=[],c={firstItem:0,lastItem:1,centerItem:1,activeItem:-1,activePage:0,items:0,pages:0},
W=b.scrollSource?h(b.scrollSource):w,H=h(b.prev),I=h(b.next),M=h(b.prevPage),N=h(b.nextPage),B=0,O=this.reload=function(){r=b.horizontal?w.width():w.height();K=b.horizontal?J.width():J.height();o=b.horizontal?e.outerWidth():e.outerHeight();m=e.children();j=[];n=[];d.min=0;d.max=o>r?o-r:0;c.items=m.length;if(v){var a=C(m,b.horizontal?"marginLeft":"marginTop"),i=C(m.slice(-1),b.horizontal?"marginRight":"marginBottom"),f=0,u=C(e,b.horizontal?"paddingLeft":"paddingTop"),t=C(e,b.horizontal?"paddingRight":
"paddingBottom"),y="none"!==m.css("float");o=0;m.each(function(d,i){var c=h(i),e=b.horizontal?c.outerWidth(!0):c.outerHeight(!0),g=C(c,"marginTop"),l=C(c,"marginBottom"),k=C(c,"marginLeft"),c=C(c,"marginRight"),k={size:e,offStart:o-(!d||b.horizontal?0:g),offCenter:o-Math.round(r/2-e/2),offEnd:o-r+e-(a?0:c),margins:{top:g,bottom:l,left:k,right:c}};d||(f=-(A?Math.round(r/2-e/2):0)+u,o+=u);o+=e;!b.horizontal&&!y&&l&&g&&0<d&&(o-=g<l?g:l);d===m.length-1&&(o+=t);j.push(k)});i=o-(a?0:i);d.min=f;d.max=A?
j[j.length-1].offCenter:i>r?i-r:0;e.css(b.horizontal?{width:o+"px"}:{height:o+"px"});c.activeItem>=j.length&&p.activate(j.length-1)}h.extend(c,P(d.cur));q&&(D=b.dynamicHandle?Math.round(K*r/o):b.horizontal?q.width():q.height(),D=D>K?K:D,g.max=K-D,q.css(b.horizontal?{width:D+"px"}:{height:D+"px"}));var E=0,i="",z=0;if(A)n=h.map(j,function(b){return b.offCenter});else for(;E-r<d.max;)n.push(E>d.max?d.max:E),E+=r;if(T.length){for(E=0;E<n.length;E++)i+=b.pageBuilder(z++);L=h(i).bind("click."+k,function(){S(L.index(this))}).appendTo(T.empty())}m.unbind("."+
k).bind("mouseup."+k,function(b){b.which===1&&!B&&p.activate(this)});d.cur<d.min&&l(d.min);d.cur>d.max&&l(d.max);c.pages=n.length;c.slideeSize=o;c.frameSize=r;c.sbSize=K;c.handleSize=D;x(0);Q();w.trigger(s+":load",[d,m,c])};this.prev=function(){p.activate(c.activeItem-1)};this.next=function(){p.activate(c.activeItem+1)};this.prevPage=function(){S(c.activePage-1)};this.nextPage=function(){S(c.activePage+1)};this.toStart=function(a){if(v){var c=y(a);if(a===z)l(d.min,1);else if(-1!==c){if(F)return;-1!==
c&&l(j[c].offStart)}}else a===z?l(d.min):(a=e.find(a).eq(0),a.length&&(a=b.horizontal?a.offset().left-e.offset().left:a.offset().top-e.offset().top,l(a)));x()};this.toEnd=function(a){if(v){var c=y(a);if(a===z)l(d.max,1);else if(-1!==c){if(F)return;l(j[c].offEnd)}}else a===z?l(d.max):(a=e.find(a).eq(0),a.length&&(c=b.horizontal?a.offset().left-e.offset().left:a.offset().top-e.offset().top,l(c-r+a[b.horizontal?"outerWidth":"outerHeight"]())));x()};this.toCenter=function(a){if(v){var c=y(a);a===z?l(Math.round(d.max/
2+d.min/2),1):-1!==c&&(l(j[c].offCenter),A&&p.activate(c,1))}else a===z?l(Math.round(d.max/2)):(a=e.find(a).eq(0),a.length&&(c=b.horizontal?a.offset().left-e.offset().left:a.offset().top-e.offset().top,l(c-r/2+a[b.horizontal?"outerWidth":"outerHeight"]()/2)));x()};this.activate=function(a,d){if(v&&a!==z){var f=y(a),e=c.activeItem;c.activeItem=f;m.removeClass(b.activeClass).eq(f).addClass(b.activeClass);f!==e&&m.eq(f).trigger(s+":active",[m,c]);d||(F?p.toCenter(f):V&&(f>=c.lastItem?p.toStart(f):f<=
c.firstItem&&p.toEnd(f)));Q()}};this.destroy=function(){w.add(document).add(e).add(m).add(W).add(q).add(H).add(I).add(M).add(N).unbind("."+k);e.add(q).css(b.horizontal?{left:0}:{top:0});H.add(I).removeClass(b.disabledClass);T.empty();h.removeData(t,k)};(function(){var a=h(document),i="mousemove."+k+" mouseup."+k;a.bind("keydown."+k,function(a){switch(a.keyCode||a.which){case 82:log("pos / rel / items / pages / options"),log(d,c,j,n,b)}});"static"===w.css({overflow:"hidden"}).css("position")&&w.css({position:"relative"});
"static"===J.css("position")&&J.css({position:"relative"});e.add(q).css(b.horizontal?{position:"absolute",left:0}:{position:"absolute",top:0});O();v?p.activate(b.startAt):l(b.startAt);x();b.scrollBy&&W.bind("DOMMouseScroll."+k+" mousewheel."+k,function(a){u(a,1);var a=a.originalEvent,e=0;a.wheelDelta&&(e=a.wheelDelta/120);a.detail&&(e=-a.detail/3);a=0>e;v?(a=y((F?A?c.activeItem:c.centerItem:c.firstItem)+(a?b.scrollBy:-b.scrollBy)),p[F?A?"activate":"toCenter":"toStart"](a)):l(d.cur+(a?b.scrollBy:-b.scrollBy));
x()});b.keyboardNav&&a.bind("keydown."+k,function(a){switch(a.keyCode||a.which){case b.horizontal?37:38:u(a);b.keyboardNavByPages?p.prevPage():p.prev();break;case b.horizontal?39:40:u(a),b.keyboardNavByPages?p.nextPage():p.next()}});b.prev&&H.bind("click."+k,function(a){u(a);p.prev()});b.next&&I.bind("click."+k,function(a){u(a);p.next()});b.prevPage&&M.bind("click."+k,function(a){u(a);p.prevPage()});b.nextPage&&N.bind("click."+k,function(a){u(a);p.nextPage()});b.dragContent&&e.bind("mousedown."+k,
function(c){if(1===c.which){u(c);var g=c.clientX,j=c.clientY,o=d.cur,p=+new Date,q=c.target,m=0;e.addClass(b.draggedClass);R();a.bind(i,function(c){var f="mouseup"===c.type,r=b.horizontal?c.clientX-g:c.clientY-j,n=o-r;!m&&10<Math.abs(r)&&(m=1,e.trigger(s+":dragStart",[d]));n>d.max?n=b.elasticBounds?d.max+(n-d.max)/6:d.max:n<d.min&&(n=b.elasticBounds?d.min+(n-d.min)/6:d.min);if(f){a.unbind(i);e.removeClass(b.draggedClass);var t=+new Date-p,t=300>t?Math.ceil(Math.pow(6/(t/300),2)*Math.abs(r)/120):0,
n=n+(0<r?-t:t)}m&&(u(c),q&&(h(q).bind("click."+k,function X(a){u(a,true);h(this).unbind("click."+k,X)}),q=0),B=!f,l(n,f,f?b.speed:0),x(f?null:0),m&&e.trigger(s+":drag",[d]),f&&e.trigger(s+":dragEnd",[d]))})}});q&&b.dragHandle&&q.bind("mousedown."+k,function(c){if(1===c.which){u(c);var e=c.clientX,h=c.clientY,k=g.cur,j=-g.cur,n=g.max-g.cur,m=0;q.addClass(b.draggedClass);R();a.bind(i,function(c){u(c);var f="mouseup"===c.type,c=b.horizontal?c.clientX-e:c.clientY-h,o=k+c,p=+new Date;B=!f;f&&(a.unbind(i),
q.removeClass(b.draggedClass));if(c<n+5&&c>j-5||f){g.cur=o>g.max?g.max:o<g.min?g.min:o;q.stop().css(b.horizontal?{left:g.cur+"px"}:{top:g.cur+"px"});m||q.trigger(s+":dragStart",[g]);q.trigger(s+":drag",[g]);f&&q.trigger(s+":dragEnd",[g]);if(m<=p||f||c>n||c<j)m=p+50,l(Math.round(g.cur/g.max*(d.max-d.min))+d.min,f,f?b.speed:50);U()}})}})})()}var s="sly",k="plugin_"+s;h.fn[s]=function(t){var b=!1,l=Array.prototype.slice.call(arguments,1),x={};h.isPlainObject(t)?x=h.extend({},h.fn[s].defaults,t):b=!1===
t?"destroy":t;return this.each(function(t,s){var y=h.data(s,k)||h.data(s,k,new O(s,x));h.isFunction(y[b])&&y[b].apply(y,l)})};h.fn[s].defaults={horizontal:0,itemNav:0,scrollBar:null,dynamicHandle:1,dragHandle:1,pagesBar:null,pageBuilder:function(h){return"<li>"+(h+1)+"</li>"},prev:null,next:null,prevPage:null,nextPage:null,scrollBy:0,dragContent:0,elasticBounds:0,speed:300,easing:"swing",scrollSource:null,startAt:0,keyboardNav:0,keyboardNavByPages:0,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}})(jQuery);
