(function(f,E){function S(v,b){function o(a,q,s){s=H(s)?s:b.speed;q&&w&&(q=T(a),G?(a=j[q.centerItem].offCenter,g[A?"activate":"toCenter"](q.centerItem,1)):a>c.min&&a<c.max&&(a=j[q.firstItem].offStart));if(!C||!b.elasticBounds)a=a<c.min?c.min:a,a=a>c.max?c.max:a;a!==c.cur&&(c.cur=a,f.extend(d,T(c.cur)),U(),V(),!C&&h.trigger(r+":move",[c,l,d]),a=b.horizontal?{left:-c.cur+"px"}:{top:-c.cur+"px"},10<s?i.animate(a,s,C?"swing":b.easing,function(){!C&&h.trigger(r+":moveEnd",[c,l,d])}):(i.css(a),!C&&h.trigger(r+
":moveEnd",[c,l,d])))}function y(a){n&&(e.cur=Math.round((c.cur-c.min)/(c.max-c.min)*e.max),e.cur=e.cur<e.min?e.min:e.cur>e.max?e.max:e.cur,n.stop().animate(b.horizontal?{left:e.cur+"px"}:{top:e.cur+"px"},H(a)?a:b.speed,b.easing));X()}function X(){N.length&&N.removeClass(b.activeClass).eq(d.activePage).addClass(b.activeClass)}function V(){i.add(n).stop()}function D(a){return H(a)?0>a?0:a>j.length-1?j.length-1:a:a===E?-1:l.index(a)}function F(a,b){return parseInt(a.css(b),10)}function T(a){for(var b=
{},s=A?0:p/2,d=0;d<t.length;d++){if(a>=c.max||d===t.length-1){b.activePage=t.length-1;break}if(a<=t[d]+s){b.activePage=d;break}}if(w){for(var e=d=s=!1,f=0;f<j.length;f++){!1===s&&a<=j[f].offStart&&(s=f);!1===e&&a-j[f].size/2<=j[f].offCenter&&(e=f);if(f===j.length-1||!1===d&&a<j[f+1].offEnd)d=f;if(!1!==d)break}b.firstItem=H(s)?s:0;b.centerItem=H(e)?e:b.firstItem;b.lastItem=H(d)?d:b.centerItem}return b}function U(){if(w){var a=0===d.activeItem,q=d.activeItem>=j.length-1;I.is("button,input")&&I.prop("disabled",
a);J.is("button,input")&&J.prop("disabled",q);I[a?"removeClass":"addClass"](b.disabledClass);J[q?"removeClass":"addClass"](b.disabledClass)}N.length&&(a=c.cur<=c.min,q=c.cur>=c.max,O.is("button,input")&&O.prop("disabled",a),P.is("button,input")&&P.prop("disabled",q),O[a?"removeClass":"addClass"](b.disabledClass),P[q?"removeClass":"addClass"](b.disabledClass))}function u(a,b){var c=a||window.event;c.preventDefault?c.preventDefault():c.returnValue=!1;b&&c.stopPropagation?c.stopPropagation():c.cancelBubble=
!0}function H(a){return!isNaN(parseFloat(a))&&isFinite(a)}var g=this,h=f(v),i=h.children().eq(0),p=0,k=0,c={cur:0,max:0,min:0},K=f(b.scrollBar).eq(0),n=K.length?K.children().eq(0):0,L=0,z=0,e={cur:0,max:0,min:0},W=f(b.pagesBar),N=0,t=[],Y="smart"===b.itemNav,A="forceCentered"===b.itemNav,G="centered"===b.itemNav||A,w="basic"===b.itemNav||Y||G||A,l=0,j=[],d={firstItem:0,lastItem:1,centerItem:1,activeItem:-1,activePage:0,items:0,pages:0},Z=b.scrollSource?f(b.scrollSource):h,S=b.dragSource?f(b.dragSource):
h,I=f(b.prev),J=f(b.next),O=f(b.prevPage),P=f(b.nextPage),M=0,$=0,C=0,fa=this.reload=function(){var a=0,q=f.extend({},c);clearTimeout(M);p=b.horizontal?h.width():h.height();L=b.horizontal?K.width():K.height();k=b.horizontal?i.outerWidth():i.outerHeight();l=i.children();j=[];t=[];c.min=0;c.max=k>p?k-p:0;d.items=l.length;if(w){var s=F(l,b.horizontal?"marginLeft":"marginTop"),B=F(l.slice(-1),b.horizontal?"marginRight":"marginBottom"),u=0,v=F(i,b.horizontal?"paddingLeft":"paddingTop"),ba=F(i,b.horizontal?
"paddingRight":"paddingBottom"),ca="none"!==l.css("float"),a=s?0:B;k=0;l.each(function(a,c){var d=f(c),q=b.horizontal?d.outerWidth(!0):d.outerHeight(!0),e=F(d,"marginTop"),g=F(d,"marginBottom"),i=F(d,"marginLeft"),d=F(d,"marginRight"),i={size:q,offStart:k-(!a||b.horizontal?0:e),offCenter:k-Math.round(p/2-q/2),offEnd:k-p+q-(s?0:d),margins:{top:e,bottom:g,left:i,right:d}};a||(u=-(A?Math.round(p/2-q/2):0)+v,k+=v);k+=q;!b.horizontal&&!ca&&g&&(e&&0<a)&&(k-=e<g?e:g);a===l.length-1&&(k+=ba);j.push(i)});
i.css(b.horizontal?{width:k+"px"}:{height:k+"px"});k-=a;c.min=u;c.max=A?j[j.length-1].offCenter:k>p?k-p:0;d.activeItem>=j.length&&g.activate(j.length-1)}f.extend(d,T(c.cur));n&&(z=b.dynamicHandle?Math.round(L*p/k):b.horizontal?n.width():n.height(),z=z>L?L:z,z=z<b.minHandleSize?b.minHandleSize:z,e.max=L-z,n.css(b.horizontal?{width:z+"px"}:{height:z+"px"}));var x=0,B="",ea=0;if(A)t=f.map(j,function(a){return a.offCenter});else for(;x-p<c.max;){var aa=x>c.max?c.max:x;t.push(aa);x+=p;if(x>c.max&&w&&c.max-
aa<(j[j.length-1].size-a)/2){t[t.length-1]=c.max;break}}if(W.length){for(a=0;a<t.length;a++)B+=b.pageBuilder(ea++);N=f(B).bind("click."+m,function(){g.activatePage(N.index(this))}).appendTo(W.empty())}l.unbind("."+m).bind("mouseup."+m,function(a){a.which===1&&!C&&g.activate(this)});c.cur<c.min&&o(c.min);c.cur>c.max&&o(c.max);d.pages=t.length;d.slideeSize=k;d.frameSize=p;d.sbSize=L;d.handleSize=z;y(0);U();w&&b.cycleBy&&(B="mouseenter."+m+" mouseleave."+m,b.pauseOnHover&&h.unbind(B).bind(B,function(a){!$&&
g.cycle(a.type==="mouseenter",1)}),g.cycle(b.startPaused));h.trigger(r+":load",[f.extend({},c,{old:q}),l,d])};this.prev=function(){g.activate(d.activeItem-1)};this.next=function(){g.activate(d.activeItem+1)};this.prevPage=function(){g.activatePage(d.activePage-1)};this.nextPage=function(){g.activatePage(d.activePage+1)};this.toStart=function(a){if(w){var d=D(a);if(a===E)o(c.min,1);else if(-1!==d){if(G)return;-1!==d&&o(j[d].offStart)}}else a===E?o(c.min):(a=i.find(a).eq(0),a.length&&(a=b.horizontal?
a.offset().left-i.offset().left:a.offset().top-i.offset().top,o(a)));y()};this.toEnd=function(a){if(w){var d=D(a);if(a===E)o(c.max,1);else if(-1!==d){if(G)return;o(j[d].offEnd)}}else a===E?o(c.max):(a=i.find(a).eq(0),a.length&&(d=b.horizontal?a.offset().left-i.offset().left:a.offset().top-i.offset().top,o(d-p+a[b.horizontal?"outerWidth":"outerHeight"]())));y()};this.toCenter=function(a){if(w){var d=D(a);a===E?o(Math.round(c.max/2+c.min/2),1):-1!==d&&(o(j[d].offCenter),A&&g.activate(d,1))}else a===
E?o(Math.round(c.max/2)):(a=i.find(a).eq(0),a.length&&(d=b.horizontal?a.offset().left-i.offset().left:a.offset().top-i.offset().top,o(d-p/2+a[b.horizontal?"outerWidth":"outerHeight"]()/2)));y()};this.activate=function(a,c){if(w&&a!==E){var e=D(a),f=d.activeItem;d.activeItem=e;l.removeClass(b.activeClass).eq(e).addClass(b.activeClass);e!==f&&l.eq(e).trigger(r+":active",[l,d]);c||(G?g.toCenter(e):Y&&(e>=d.lastItem?g.toStart(e):e<=d.firstItem&&g.toEnd(e)));U()}};this.activatePage=function(a){a=0>a?0:
a>=t.length?t.length-1:a;o(t[a],w);y()};this.cycle=function(a,e){w&&b.cycleBy&&(e||($=!!a),a?M&&(M=clearTimeout(M),h.trigger(r+":cyclePause",[c,l,d])):M||(h.trigger(r+":cycleStart",[c,l,d]),function B(){M=setTimeout(function(){if(!C)switch(b.cycleBy){case "items":g.activate(d.activeItem>=j.length-1?0:d.activeItem+1);break;case "pages":g.activatePage(d.activePage>=t.length-1?0:d.activePage+1)}h.trigger(r+":cycle",[c,l,d]);B()},b.cycleInterval)}()))};this.destroy=function(){h.add(document).add(i).add(l).add(Z).add(n).add(I).add(J).add(O).add(P).unbind("."+
m);i.add(n).css(b.horizontal?{left:0}:{top:0});I.add(J).removeClass(b.disabledClass);W.empty();f.removeData(v,m)};var Q=f(document),R="mousemove."+m+" mouseup."+m;"static"===h.css({overflow:"hidden"}).css("position")&&h.css({position:"relative"});"static"===K.css("position")&&K.css({position:"relative"});i.add(n).css(b.horizontal?{position:"absolute",left:0}:{position:"absolute",top:0});fa();w?g.activate(b.startAt):o(b.startAt);y();b.scrollBy&&Z.bind("DOMMouseScroll."+m+" mousewheel."+m,function(a){if(c.min!==
c.max){u(a,1);var a=a.originalEvent,e=0;a.wheelDelta&&(e=a.wheelDelta/120);a.detail&&(e=-a.detail/3);a=0>e;w?(a=D((G?A?d.activeItem:d.centerItem:d.firstItem)+(a?b.scrollBy:-b.scrollBy)),g[G?A?"activate":"toCenter":"toStart"](a)):o(c.cur+(a?b.scrollBy:-b.scrollBy));y()}});b.keyboardNav&&Q.bind("keydown."+m,function(a){switch(a.keyCode||a.which){case b.horizontal?37:38:u(a);b.keyboardNavByPages?g.prevPage():g.prev();break;case b.horizontal?39:40:u(a),b.keyboardNavByPages?g.nextPage():g.next()}});b.prev&&
I.bind("click."+m,function(a){u(a);g.prev()});b.next&&J.bind("click."+m,function(a){u(a);g.next()});b.prevPage&&O.bind("click."+m,function(a){u(a);g.prevPage()});b.nextPage&&P.bind("click."+m,function(a){u(a);g.nextPage()});b.dragContent&&S.bind("mousedown."+m,function(a){if(1===a.which){u(a);var d=a.clientX,e=a.clientY,g=c.cur,j=+new Date,k=a.target,l=0;i.addClass(b.draggedClass);V();Q.bind(R,function(a){var x="mouseup"===a.type,n=b.horizontal?a.clientX-d:a.clientY-e,h=g-n;!l&&10<Math.abs(n)&&(l=
1,i.trigger(r+":dragStart",[c]));h>c.max?h=b.elasticBounds?c.max+(h-c.max)/6:c.max:h<c.min&&(h=b.elasticBounds?c.min+(h-c.min)/6:c.min);if(x){Q.unbind(R);i.removeClass(b.draggedClass);var p=+new Date-j,p=300>p?Math.ceil(Math.pow(6/(p/300),2)*Math.abs(n)/120):0,h=h+(0<n?-p:p)}l&&(u(a),k&&(f(k).bind("click."+m,function da(a){u(a,true);f(this).unbind("click."+m,da)}),k=0),C=!x,o(h,x,x?b.speed:0),y(x?null:0),l&&i.trigger(r+":drag",[c]),x&&i.trigger(r+":dragEnd",[c]))})}});n&&b.dragHandle&&n.bind("mousedown."+
m,function(a){if(1===a.which){u(a);var d=a.clientX,f=a.clientY,g=e.cur,i=-e.cur,k=e.max-e.cur,j=0;n.addClass(b.draggedClass);V();Q.bind(R,function(a){u(a);var h="mouseup"===a.type,a=b.horizontal?a.clientX-d:a.clientY-f,l=g+a,m=+new Date;C=!h;h&&(Q.unbind(R),n.removeClass(b.draggedClass));if(a<k+5&&a>i-5||h){e.cur=l>e.max?e.max:l<e.min?e.min:l;n.stop().css(b.horizontal?{left:e.cur+"px"}:{top:e.cur+"px"});j||n.trigger(r+":dragStart",[e]);n.trigger(r+":drag",[e]);h&&n.trigger(r+":dragEnd",[e]);if(j<=
m||h||a>k||a<i)j=m+50,o(Math.round(e.cur/e.max*(c.max-c.min))+c.min,h,h?b.speed:50);X()}})}})}var r="sly",m="plugin_"+r;f.fn[r]=function(v){var b=!1,o=Array.prototype.slice.call(arguments,1),y={};f.isPlainObject(v)?y=f.extend({},f.fn[r].defaults,v):b=!1===v?"destroy":v;return this.each(function(r,v){var D=f.data(v,m)||f.data(v,m,new S(v,y));f.isFunction(D[b])&&D[b].apply(D,o)})};f.fn[r].defaults={horizontal:0,itemNav:0,scrollBar:null,dynamicHandle:1,dragHandle:1,minHandleSize:50,pagesBar:null,pageBuilder:function(f){return"<li>"+
(f+1)+"</li>"},prev:null,next:null,prevPage:null,nextPage:null,cycleBy:0,cycleInterval:5E3,pauseOnHover:1,startPaused:0,scrollBy:0,dragContent:0,elasticBounds:0,speed:100,easing:"swing",scrollSource:null,dragSource:null,startAt:0,keyboardNav:0,keyboardNavByPages:0,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}})(jQuery);
