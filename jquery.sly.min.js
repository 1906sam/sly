(function(g,B){function Q(w,a){function q(b,v,e){e=F(e)?e:a.speed;v&&r&&(v=R(b),E?(b=j[v.centerItem].offCenter,h[z?"activate":"toCenter"](v.centerItem,1)):b>d.min&&b<d.max&&(b=j[v.firstItem].offStart));if(!A||!a.elasticBounds)b=b<d.min?d.min:b,b=b>d.max?d.max:b;b!==d.cur&&(d.cur=b,g.extend(c,R(d.cur)),S(),T(),!A&&o.trigger(t+":move",[d,m,c]),b=a.horizontal?{left:-d.cur+"px"}:{top:-d.cur+"px"},10<e?i.animate(b,e,A?"swing":a.easing,function(){!A&&o.trigger(t+":moveEnd",[d,m,c])}):(i.css(b),!A&&o.trigger(t+
":moveEnd",[d,m,c])))}function x(b){p&&(f.cur=Math.round((d.cur-d.min)/(d.max-d.min)*f.max),f.cur=f.cur<f.min?f.min:f.cur>f.max?f.max:f.cur,p.stop().animate(a.horizontal?{left:f.cur+"px"}:{top:f.cur+"px"},F(b)?b:a.speed,a.easing));V()}function V(){M.length&&M.removeClass(a.activeClass).eq(c.activePage).addClass(a.activeClass)}function T(){i.add(p).stop()}function y(b){return F(b)?0>b?0:b>j.length-1?j.length-1:b:b===B?-1:m.index(b)}function C(b,a){return parseInt(b.css(a),10)}function R(b){for(var a=
{},e=z?0:s/2,c=0;c<k.length;c++){if(b>=d.max||c===k.length-1){a.activePage=k.length-1;break}if(b<=k[c]+e){a.activePage=c;break}}if(r){for(var f=c=e=!1,g=0;g<j.length;g++){!1===e&&b<=j[g].offStart&&(e=g);!1===f&&b-j[g].size/2<=j[g].offCenter&&(f=g);if(g===j.length-1||!1===c&&b<j[g+1].offEnd)c=g;if(!1!==c)break}a.firstItem=F(e)?e:0;a.centerItem=F(f)?f:a.firstItem;a.lastItem=F(c)?c:a.centerItem}return a}function S(){if(r){var b=0===c.activeItem,v=c.activeItem>=j.length-1;G.is("button,input")&&G.prop("disabled",
b);H.is("button,input")&&H.prop("disabled",v);G[b?"removeClass":"addClass"](a.disabledClass);H[v?"removeClass":"addClass"](a.disabledClass)}M.length&&(b=d.cur<=d.min,v=d.cur>=d.max,N.is("button,input")&&N.prop("disabled",b),O.is("button,input")&&O.prop("disabled",v),N[b?"removeClass":"addClass"](a.disabledClass),O[v?"removeClass":"addClass"](a.disabledClass))}function u(a,d){var e=a||window.event;e.preventDefault?e.preventDefault():e.returnValue=!1;d&&e.stopPropagation?e.stopPropagation():e.cancelBubble=
!0}function F(a){return!isNaN(parseFloat(a))&&isFinite(a)}var h=this,o=g(w),i=o.children().eq(0),s=0,l=0,d={cur:0,max:0,min:0},I=g(a.scrollBar),p=I.length?I.children().eq(0):0,J=0,D=0,f={cur:0,max:0,min:0},U=g(a.pagesBar),M=0,k=[],W="smart"===a.itemNav,z="forceCentered"===a.itemNav,E="centered"===a.itemNav||z,r="basic"===a.itemNav||W||E||z,m=0,j=[],c={firstItem:0,lastItem:1,centerItem:1,activeItem:-1,activePage:0,items:0,pages:0},X=a.scrollSource?g(a.scrollSource):o,Q=a.dragSource?g(a.dragSource):
o,G=g(a.prev),H=g(a.next),N=g(a.prevPage),O=g(a.nextPage),K=0,Y=0,A=0,ba=this.reload=function(){var b=0;clearTimeout(K);s=a.horizontal?o.width():o.height();J=a.horizontal?I.width():I.height();l=a.horizontal?i.outerWidth():i.outerHeight();m=i.children();j=[];k=[];d.min=0;d.max=l>s?l-s:0;c.items=m.length;if(r){var v=C(m,a.horizontal?"marginLeft":"marginTop"),e=C(m.slice(-1),a.horizontal?"marginRight":"marginBottom"),P=0,u=C(i,a.horizontal?"paddingLeft":"paddingTop"),w=C(i,a.horizontal?"paddingRight":
"paddingBottom"),y="none"!==m.css("float"),b=v?0:e;l=0;m.each(function(b,e){var d=g(e),c=a.horizontal?d.outerWidth(!0):d.outerHeight(!0),f=C(d,"marginTop"),h=C(d,"marginBottom"),i=C(d,"marginLeft"),d=C(d,"marginRight"),i={size:c,offStart:l-(!b||a.horizontal?0:f),offCenter:l-Math.round(s/2-c/2),offEnd:l-s+c-(v?0:d),margins:{top:f,bottom:h,left:i,right:d}};b||(P=-(z?Math.round(s/2-c/2):0)+u,l+=u);l+=c;!a.horizontal&&!y&&h&&f&&0<b&&(l-=f<h?f:h);b===m.length-1&&(l+=w);j.push(i)});i.css(a.horizontal?{width:l+
"px"}:{height:l+"px"});l-=b;d.min=P;d.max=z?j[j.length-1].offCenter:l>s?l-s:0;c.activeItem>=j.length&&h.activate(j.length-1)}g.extend(c,R(d.cur));p&&(D=a.dynamicHandle?Math.round(J*s/l):a.horizontal?p.width():p.height(),D=D>J?J:D,f.max=J-D,p.css(a.horizontal?{width:D+"px"}:{height:D+"px"}));var L=0,e="",aa=0;if(z)k=g.map(j,function(a){return a.offCenter});else for(;L-s<d.max;){var Z=L>d.max?d.max:L;k.push(Z);L+=s;if(L>d.max&&r&&d.max-Z<(j[j.length-1].size-b)/2){k[k.length-1]=d.max;break}}if(U.length){for(b=
0;b<k.length;b++)e+=a.pageBuilder(aa++);M=g(e).bind("click."+n,function(){h.activatePage(M.index(this))}).appendTo(U.empty())}m.unbind("."+n).bind("mouseup."+n,function(a){a.which===1&&!A&&h.activate(this)});d.cur<d.min&&q(d.min);d.cur>d.max&&q(d.max);c.pages=k.length;c.slideeSize=l;c.frameSize=s;c.sbSize=J;c.handleSize=D;x(0);S();r&&a.cycleBy&&(e="mouseenter."+n+" mouseleave."+n,a.pauseOnHover&&o.unbind(e).bind(e,function(a){!Y&&h.cycle(a.type==="mouseenter",1)}),h.cycle(a.startPaused));o.trigger(t+
":load",[d,m,c])};this.prev=function(){h.activate(c.activeItem-1)};this.next=function(){h.activate(c.activeItem+1)};this.prevPage=function(){h.activatePage(c.activePage-1)};this.nextPage=function(){h.activatePage(c.activePage+1)};this.toStart=function(b){if(r){var c=y(b);if(b===B)q(d.min,1);else if(-1!==c){if(E)return;-1!==c&&q(j[c].offStart)}}else b===B?q(d.min):(b=i.find(b).eq(0),b.length&&(b=a.horizontal?b.offset().left-i.offset().left:b.offset().top-i.offset().top,q(b)));x()};this.toEnd=function(b){if(r){var c=
y(b);if(b===B)q(d.max,1);else if(-1!==c){if(E)return;q(j[c].offEnd)}}else b===B?q(d.max):(b=i.find(b).eq(0),b.length&&(c=a.horizontal?b.offset().left-i.offset().left:b.offset().top-i.offset().top,q(c-s+b[a.horizontal?"outerWidth":"outerHeight"]())));x()};this.toCenter=function(b){if(r){var c=y(b);b===B?q(Math.round(d.max/2+d.min/2),1):-1!==c&&(q(j[c].offCenter),z&&h.activate(c,1))}else b===B?q(Math.round(d.max/2)):(b=i.find(b).eq(0),b.length&&(c=a.horizontal?b.offset().left-i.offset().left:b.offset().top-
i.offset().top,q(c-s/2+b[a.horizontal?"outerWidth":"outerHeight"]()/2)));x()};this.activate=function(b,d){if(r&&b!==B){var e=y(b),f=c.activeItem;c.activeItem=e;m.removeClass(a.activeClass).eq(e).addClass(a.activeClass);e!==f&&m.eq(e).trigger(t+":active",[m,c]);d||(E?h.toCenter(e):W&&(e>=c.lastItem?h.toStart(e):e<=c.firstItem&&h.toEnd(e)));S()}};this.activatePage=function(a){a=0>a?0:a>=k.length?k.length-1:a;q(k[a],r);x()};this.cycle=function(b,f){r&&a.cycleBy&&(f||(Y=!!b),b?K&&(K=clearTimeout(K),o.trigger(t+
":cyclePause",[d,m,c])):K||(o.trigger(t+":cycleStart",[d,m,c]),function P(){K=setTimeout(function(){if(!A)switch(a.cycleBy){case "items":h.activate(c.activeItem>=j.length-1?0:c.activeItem+1);break;case "pages":h.activatePage(c.activePage>=k.length-1?0:c.activePage+1)}o.trigger(t+":cycle",[d,m,c]);P()},a.cycleInterval)}()))};this.destroy=function(){o.add(document).add(i).add(m).add(X).add(p).add(G).add(H).add(N).add(O).unbind("."+n);i.add(p).css(a.horizontal?{left:0}:{top:0});G.add(H).removeClass(a.disabledClass);
U.empty();g.removeData(w,n)};(function(){var b=g(document),j="mousemove."+n+" mouseup."+n;"static"===o.css({overflow:"hidden"}).css("position")&&o.css({position:"relative"});"static"===I.css("position")&&I.css({position:"relative"});i.add(p).css(a.horizontal?{position:"absolute",left:0}:{position:"absolute",top:0});ba();r?h.activate(a.startAt):q(a.startAt);x();a.scrollBy&&X.bind("DOMMouseScroll."+n+" mousewheel."+n,function(b){if(d.min!==d.max){u(b,1);var b=b.originalEvent,f=0;b.wheelDelta&&(f=b.wheelDelta/
120);b.detail&&(f=-b.detail/3);b=0>f;r?(b=y((E?z?c.activeItem:c.centerItem:c.firstItem)+(b?a.scrollBy:-a.scrollBy)),h[E?z?"activate":"toCenter":"toStart"](b)):q(d.cur+(b?a.scrollBy:-a.scrollBy));x()}});a.keyboardNav&&b.bind("keydown."+n,function(b){switch(b.keyCode||b.which){case a.horizontal?37:38:u(b);a.keyboardNavByPages?h.prevPage():h.prev();break;case a.horizontal?39:40:u(b),a.keyboardNavByPages?h.nextPage():h.next()}});a.prev&&G.bind("click."+n,function(a){u(a);h.prev()});a.next&&H.bind("click."+
n,function(a){u(a);h.next()});a.prevPage&&N.bind("click."+n,function(a){u(a);h.prevPage()});a.nextPage&&O.bind("click."+n,function(a){u(a);h.nextPage()});a.dragContent&&Q.bind("mousedown."+n,function(c){if(1===c.which){u(c);var f=c.clientX,h=c.clientY,l=d.cur,m=+new Date,p=c.target,o=0;i.addClass(a.draggedClass);T();b.bind(j,function(c){var e="mouseup"===c.type,s=a.horizontal?c.clientX-f:c.clientY-h,k=l-s;!o&&10<Math.abs(s)&&(o=1,i.trigger(t+":dragStart",[d]));k>d.max?k=a.elasticBounds?d.max+(k-d.max)/
6:d.max:k<d.min&&(k=a.elasticBounds?d.min+(k-d.min)/6:d.min);if(e){b.unbind(j);i.removeClass(a.draggedClass);var r=+new Date-m,r=300>r?Math.ceil(Math.pow(6/(r/300),2)*Math.abs(s)/120):0,k=k+(0<s?-r:r)}o&&(u(c),p&&(g(p).bind("click."+n,function $(a){u(a,true);g(this).unbind("click."+n,$)}),p=0),A=!e,q(k,e,e?a.speed:0),x(e?null:0),o&&i.trigger(t+":drag",[d]),e&&i.trigger(t+":dragEnd",[d]))})}});p&&a.dragHandle&&p.bind("mousedown."+n,function(c){if(1===c.which){u(c);var g=c.clientX,h=c.clientY,i=f.cur,
k=-f.cur,l=f.max-f.cur,m=0;p.addClass(a.draggedClass);T();b.bind(j,function(c){u(c);var e="mouseup"===c.type,c=a.horizontal?c.clientX-g:c.clientY-h,n=i+c,o=+new Date;A=!e;e&&(b.unbind(j),p.removeClass(a.draggedClass));if(c<l+5&&c>k-5||e){f.cur=n>f.max?f.max:n<f.min?f.min:n;p.stop().css(a.horizontal?{left:f.cur+"px"}:{top:f.cur+"px"});m||p.trigger(t+":dragStart",[f]);p.trigger(t+":drag",[f]);e&&p.trigger(t+":dragEnd",[f]);if(m<=o||e||c>l||c<k)m=o+50,q(Math.round(f.cur/f.max*(d.max-d.min))+d.min,e,
e?a.speed:50);V()}})}})})()}var t="sly",n="plugin_"+t;g.fn[t]=function(w){var a=!1,q=Array.prototype.slice.call(arguments,1),x={};g.isPlainObject(w)?x=g.extend({},g.fn[t].defaults,w):a=!1===w?"destroy":w;return this.each(function(t,w){var y=g.data(w,n)||g.data(w,n,new Q(w,x));g.isFunction(y[a])&&y[a].apply(y,q)})};g.fn[t].defaults={horizontal:0,itemNav:0,scrollBar:null,dynamicHandle:1,dragHandle:1,pagesBar:null,pageBuilder:function(g){return"<li>"+(g+1)+"</li>"},prev:null,next:null,prevPage:null,
nextPage:null,cycleBy:0,cycleInterval:5E3,pauseOnHover:1,startPaused:0,scrollBy:0,dragContent:0,elasticBounds:0,speed:300,easing:"swing",scrollSource:null,dragSource:null,startAt:0,keyboardNav:0,keyboardNavByPages:0,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}})(jQuery);
