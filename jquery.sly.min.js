(function(f,C){function R(u,b){function p(a,v,g){g=F(g)?g:b.speed;v&&w&&(v=S(a),E?(a=i[v.centerItem].offCenter,h[A?"activate":"toCenter"](v.centerItem,1)):a>c.min&&a<c.max&&(a=i[v.firstItem].offStart));if(!B||!b.elasticBounds)a=a<c.min?c.min:a,a=a>c.max?c.max:a;a!==c.cur&&(c.cur=a,f.extend(d,S(c.cur)),T(),U(),!B&&q.trigger(s+":move",[c,l,d]),a=b.horizontal?{left:-c.cur+"px"}:{top:-c.cur+"px"},10<g?j.animate(a,g,B?"swing":b.easing,function(){!B&&q.trigger(s+":moveEnd",[c,l,d])}):(j.css(a),!B&&q.trigger(s+
":moveEnd",[c,l,d])))}function x(a){n&&(e.cur=Math.round((c.cur-c.min)/(c.max-c.min)*e.max),e.cur=e.cur<e.min?e.min:e.cur>e.max?e.max:e.cur,n.stop().animate(b.horizontal?{left:e.cur+"px"}:{top:e.cur+"px"},F(a)?a:b.speed,b.easing));W()}function W(){M.length&&M.removeClass(b.activeClass).eq(d.activePage).addClass(b.activeClass)}function U(){j.add(n).stop()}function y(a){return F(a)?0>a?0:a>i.length-1?i.length-1:a:a===C?-1:l.index(a)}function D(a,b){return parseInt(a.css(b),10)}function S(a){for(var b=
{},g=A?0:m/2,d=0;d<r.length;d++){if(a>=c.max||d===r.length-1){b.activePage=r.length-1;break}if(a<=r[d]+g){b.activePage=d;break}}if(w){for(var e=d=g=!1,f=0;f<i.length;f++){!1===g&&a<=i[f].offStart&&(g=f);!1===e&&a-i[f].size/2<=i[f].offCenter&&(e=f);if(f===i.length-1||!1===d&&a<i[f+1].offEnd)d=f;if(!1!==d)break}b.firstItem=F(g)?g:0;b.centerItem=F(e)?e:b.firstItem;b.lastItem=F(d)?d:b.centerItem}return b}function T(){if(w){var a=0===d.activeItem,v=d.activeItem>=i.length-1;G.is("button,input")&&G.prop("disabled",
a);H.is("button,input")&&H.prop("disabled",v);G[a?"removeClass":"addClass"](b.disabledClass);H[v?"removeClass":"addClass"](b.disabledClass)}M.length&&(a=c.cur<=c.min,v=c.cur>=c.max,N.is("button,input")&&N.prop("disabled",a),O.is("button,input")&&O.prop("disabled",v),N[a?"removeClass":"addClass"](b.disabledClass),O[v?"removeClass":"addClass"](b.disabledClass))}function t(a,b){var c=a||window.event;c.preventDefault?c.preventDefault():c.returnValue=!1;b&&c.stopPropagation?c.stopPropagation():c.cancelBubble=
!0}function F(a){return!isNaN(parseFloat(a))&&isFinite(a)}var h=this,q=f(u),j=q.children().eq(0),m=0,k=0,c={cur:0,max:0,min:0},I=f(b.scrollBar),n=I.length?I.children().eq(0):0,J=0,z=0,e={cur:0,max:0,min:0},V=f(b.pagesBar),M=0,r=[],X="smart"===b.itemNav,A="forceCentered"===b.itemNav,E="centered"===b.itemNav||A,w="basic"===b.itemNav||X||E||A,l=0,i=[],d={firstItem:0,lastItem:1,centerItem:1,activeItem:-1,activePage:0,items:0,pages:0},Y=b.scrollSource?f(b.scrollSource):q,R=b.dragSource?f(b.dragSource):
q,G=f(b.prev),H=f(b.next),N=f(b.prevPage),O=f(b.nextPage),K=0,Z=0,B=0,ea=this.reload=function(){var a=0;clearTimeout(K);m=b.horizontal?q.width():q.height();J=b.horizontal?I.width():I.height();k=b.horizontal?j.outerWidth():j.outerHeight();l=j.children();i=[];r=[];c.min=0;c.max=k>m?k-m:0;d.items=l.length;if(w){var v=D(l,b.horizontal?"marginLeft":"marginTop"),g=D(l.slice(-1),b.horizontal?"marginRight":"marginBottom"),t=0,u=D(j,b.horizontal?"paddingLeft":"paddingTop"),y=D(j,b.horizontal?"paddingRight":
"paddingBottom"),ba="none"!==l.css("float"),a=v?0:g;k=0;l.each(function(a,c){var d=f(c),g=b.horizontal?d.outerWidth(!0):d.outerHeight(!0),e=D(d,"marginTop"),h=D(d,"marginBottom"),j=D(d,"marginLeft"),d=D(d,"marginRight"),j={size:g,offStart:k-(!a||b.horizontal?0:e),offCenter:k-Math.round(m/2-g/2),offEnd:k-m+g-(v?0:d),margins:{top:e,bottom:h,left:j,right:d}};a||(t=-(A?Math.round(m/2-g/2):0)+u,k+=u);k+=g;!b.horizontal&&!ba&&h&&(e&&0<a)&&(k-=e<h?e:h);a===l.length-1&&(k+=y);i.push(j)});j.css(b.horizontal?
{width:k+"px"}:{height:k+"px"});k-=a;c.min=t;c.max=A?i[i.length-1].offCenter:k>m?k-m:0;d.activeItem>=i.length&&h.activate(i.length-1)}f.extend(d,S(c.cur));n&&(z=b.dynamicHandle?Math.round(J*m/k):b.horizontal?n.width():n.height(),z=z>J?J:z,z=z<b.minHandleSize?b.minHandleSize:z,e.max=J-z,n.css(b.horizontal?{width:z+"px"}:{height:z+"px"}));var L=0,g="",da=0;if(A)r=f.map(i,function(a){return a.offCenter});else for(;L-m<c.max;){var $=L>c.max?c.max:L;r.push($);L+=m;if(L>c.max&&w&&c.max-$<(i[i.length-1].size-
a)/2){r[r.length-1]=c.max;break}}if(V.length){for(a=0;a<r.length;a++)g+=b.pageBuilder(da++);M=f(g).bind("click."+o,function(){h.activatePage(M.index(this))}).appendTo(V.empty())}l.unbind("."+o).bind("mouseup."+o,function(a){a.which===1&&!B&&h.activate(this)});c.cur<c.min&&p(c.min);c.cur>c.max&&p(c.max);d.pages=r.length;d.slideeSize=k;d.frameSize=m;d.sbSize=J;d.handleSize=z;x(0);T();w&&b.cycleBy&&(g="mouseenter."+o+" mouseleave."+o,b.pauseOnHover&&q.unbind(g).bind(g,function(a){!Z&&h.cycle(a.type===
"mouseenter",1)}),h.cycle(b.startPaused));q.trigger(s+":load",[c,l,d])};this.prev=function(){h.activate(d.activeItem-1)};this.next=function(){h.activate(d.activeItem+1)};this.prevPage=function(){h.activatePage(d.activePage-1)};this.nextPage=function(){h.activatePage(d.activePage+1)};this.toStart=function(a){if(w){var d=y(a);if(a===C)p(c.min,1);else if(-1!==d){if(E)return;-1!==d&&p(i[d].offStart)}}else a===C?p(c.min):(a=j.find(a).eq(0),a.length&&(a=b.horizontal?a.offset().left-j.offset().left:a.offset().top-
j.offset().top,p(a)));x()};this.toEnd=function(a){if(w){var d=y(a);if(a===C)p(c.max,1);else if(-1!==d){if(E)return;p(i[d].offEnd)}}else a===C?p(c.max):(a=j.find(a).eq(0),a.length&&(d=b.horizontal?a.offset().left-j.offset().left:a.offset().top-j.offset().top,p(d-m+a[b.horizontal?"outerWidth":"outerHeight"]())));x()};this.toCenter=function(a){if(w){var d=y(a);a===C?p(Math.round(c.max/2+c.min/2),1):-1!==d&&(p(i[d].offCenter),A&&h.activate(d,1))}else a===C?p(Math.round(c.max/2)):(a=j.find(a).eq(0),a.length&&
(d=b.horizontal?a.offset().left-j.offset().left:a.offset().top-j.offset().top,p(d-m/2+a[b.horizontal?"outerWidth":"outerHeight"]()/2)));x()};this.activate=function(a,c){if(w&&a!==C){var g=y(a),e=d.activeItem;d.activeItem=g;l.removeClass(b.activeClass).eq(g).addClass(b.activeClass);g!==e&&l.eq(g).trigger(s+":active",[l,d]);c||(E?h.toCenter(g):X&&(g>=d.lastItem?h.toStart(g):g<=d.firstItem&&h.toEnd(g)));T()}};this.activatePage=function(a){a=0>a?0:a>=r.length?r.length-1:a;p(r[a],w);x()};this.cycle=function(a,
e){w&&b.cycleBy&&(e||(Z=!!a),a?K&&(K=clearTimeout(K),q.trigger(s+":cyclePause",[c,l,d])):K||(q.trigger(s+":cycleStart",[c,l,d]),function aa(){K=setTimeout(function(){if(!B)switch(b.cycleBy){case "items":h.activate(d.activeItem>=i.length-1?0:d.activeItem+1);break;case "pages":h.activatePage(d.activePage>=r.length-1?0:d.activePage+1)}q.trigger(s+":cycle",[c,l,d]);aa()},b.cycleInterval)}()))};this.destroy=function(){q.add(document).add(j).add(l).add(Y).add(n).add(G).add(H).add(N).add(O).unbind("."+o);
j.add(n).css(b.horizontal?{left:0}:{top:0});G.add(H).removeClass(b.disabledClass);V.empty();f.removeData(u,o)};var P=f(document),Q="mousemove."+o+" mouseup."+o;"static"===q.css({overflow:"hidden"}).css("position")&&q.css({position:"relative"});"static"===I.css("position")&&I.css({position:"relative"});j.add(n).css(b.horizontal?{position:"absolute",left:0}:{position:"absolute",top:0});ea();w?h.activate(b.startAt):p(b.startAt);x();b.scrollBy&&Y.bind("DOMMouseScroll."+o+" mousewheel."+o,function(a){if(c.min!==
c.max){t(a,1);var a=a.originalEvent,e=0;a.wheelDelta&&(e=a.wheelDelta/120);a.detail&&(e=-a.detail/3);a=0>e;w?(a=y((E?A?d.activeItem:d.centerItem:d.firstItem)+(a?b.scrollBy:-b.scrollBy)),h[E?A?"activate":"toCenter":"toStart"](a)):p(c.cur+(a?b.scrollBy:-b.scrollBy));x()}});b.keyboardNav&&P.bind("keydown."+o,function(a){switch(a.keyCode||a.which){case b.horizontal?37:38:t(a);b.keyboardNavByPages?h.prevPage():h.prev();break;case b.horizontal?39:40:t(a),b.keyboardNavByPages?h.nextPage():h.next()}});b.prev&&
G.bind("click."+o,function(a){t(a);h.prev()});b.next&&H.bind("click."+o,function(a){t(a);h.next()});b.prevPage&&N.bind("click."+o,function(a){t(a);h.prevPage()});b.nextPage&&O.bind("click."+o,function(a){t(a);h.nextPage()});b.dragContent&&R.bind("mousedown."+o,function(a){if(1===a.which){t(a);var d=a.clientX,e=a.clientY,h=c.cur,i=+new Date,k=a.target,l=0;j.addClass(b.draggedClass);U();P.bind(Q,function(a){var n="mouseup"===a.type,q=b.horizontal?a.clientX-d:a.clientY-e,m=h-q;!l&&10<Math.abs(q)&&(l=
1,j.trigger(s+":dragStart",[c]));m>c.max?m=b.elasticBounds?c.max+(m-c.max)/6:c.max:m<c.min&&(m=b.elasticBounds?c.min+(m-c.min)/6:c.min);if(n){P.unbind(Q);j.removeClass(b.draggedClass);var r=+new Date-i,r=300>r?Math.ceil(Math.pow(6/(r/300),2)*Math.abs(q)/120):0,m=m+(0<q?-r:r)}l&&(t(a),k&&(f(k).bind("click."+o,function ca(a){t(a,true);f(this).unbind("click."+o,ca)}),k=0),B=!n,p(m,n,n?b.speed:0),x(n?null:0),l&&j.trigger(s+":drag",[c]),n&&j.trigger(s+":dragEnd",[c]))})}});n&&b.dragHandle&&n.bind("mousedown."+
o,function(a){if(1===a.which){t(a);var d=a.clientX,g=a.clientY,f=e.cur,h=-e.cur,j=e.max-e.cur,k=0;n.addClass(b.draggedClass);U();P.bind(Q,function(a){t(a);var i="mouseup"===a.type,a=b.horizontal?a.clientX-d:a.clientY-g,l=f+a,m=+new Date;B=!i;i&&(P.unbind(Q),n.removeClass(b.draggedClass));if(a<j+5&&a>h-5||i){e.cur=l>e.max?e.max:l<e.min?e.min:l;n.stop().css(b.horizontal?{left:e.cur+"px"}:{top:e.cur+"px"});k||n.trigger(s+":dragStart",[e]);n.trigger(s+":drag",[e]);i&&n.trigger(s+":dragEnd",[e]);if(k<=
m||i||a>j||a<h)k=m+50,p(Math.round(e.cur/e.max*(c.max-c.min))+c.min,i,i?b.speed:50);W()}})}})}var s="sly",o="plugin_"+s;f.fn[s]=function(u){var b=!1,p=Array.prototype.slice.call(arguments,1),x={};f.isPlainObject(u)?x=f.extend({},f.fn[s].defaults,u):b=!1===u?"destroy":u;return this.each(function(s,u){var y=f.data(u,o)||f.data(u,o,new R(u,x));f.isFunction(y[b])&&y[b].apply(y,p)})};f.fn[s].defaults={horizontal:0,itemNav:0,scrollBar:null,dynamicHandle:1,dragHandle:1,minHandleSize:50,pagesBar:null,pageBuilder:function(f){return"<li>"+
(f+1)+"</li>"},prev:null,next:null,prevPage:null,nextPage:null,cycleBy:0,cycleInterval:5E3,pauseOnHover:1,startPaused:0,scrollBy:0,dragContent:0,elasticBounds:0,speed:300,easing:"swing",scrollSource:null,dragSource:null,startAt:0,keyboardNav:0,keyboardNavByPages:0,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}})(jQuery);
