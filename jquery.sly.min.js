(function(d,X){function aa(n,b){var k,t,L;function l(a,u,z){o>=i&&(a=c.min);z&&b.byItems&&(tempRel=Q(a),b.centerActive?(a=j[tempRel.centerItem].offCenter,h.activate(tempRel.centerItem,1)):a>c.min&&a<c.max&&(a=j[tempRel.firstItem].offStart));if(!I||!b.elasticBounds)a=a<c.min?c.min:a,a=a>c.max?c.max:a;a!=c.cur&&(c.cur=a,d.extend(g,Q(c.cur)),R(),S(),!I&&P("onMove",A,[c,m,g]),v.animate(b.horizontal?{left:-c.cur+"px"}:{top:-c.cur+"px"},J(u)?u:b.speed,b.easing,function(){!I&&P("onMoveEnd",A,[c,m,g])}))}
function x(a){p&&(k=Math.round((c.cur-c.min)/(c.max-c.min)*t),k=k<L?L:k>t?t:k,p.stop().animate(b.horizontal?{left:k+"px"}:{top:k+"px"},J(a)?a:b.speed,b.easing));Y()}function Y(){M.length&&M.removeClass(b.activeClass).eq(g.activePage).addClass(b.activeClass)}function S(){v.add(p).stop()}function N(a){return J(a)?0>a?0:a>j.length-1?j.length-1:a:a===X?-1:m.index(a)}function E(a,b){return parseInt(a.css(b))}function T(a){b.centerActive||(a=0>a?0:a>=y.length?y.length-1:a,l(y[a],null,b.byItems),x())}function Q(a){for(var u=
{},z=o/2,d=0;d<y.length;d++){if(a>=c.max){u.activePage=y.length-1;break}if(b.centerActive?a==y[d]:a<=y[d]+z){u.activePage=d;break}}if(b.byItems){for(var f=z=!1,g=!1,d=0;d<j.length;d++){!1===z&&a<=j[d].offStart&&(z=d);!1===g&&a-j[d].size/2<=j[d].offCenter&&(g=d);if(d==j.length-1||!1===f&&a<j[d+1].offEnd)f=d;if(!1!==f)break}u.firstItem=J(z)?z:0;u.centerItem=J(g)?g:u.firstItem;u.lastItem=J(f)?f:u.centerItem}return u}function R(){b.byItems&&(B.add(C).removeClass(b.disabledClass),B.is("button,input")&&
B.prop("disabled",!1),C.is("button,input")&&C.prop("disabled",!1),0==g.activeItem&&(B.addClass(b.disabledClass),B.is("button,input")&&B.prop("disabled",!0)),g.activeItem>=j.length-1&&(C.addClass(b.disabledClass),C.is("button,input")&&C.prop("disabled",!0)));M.length&&(F.add(G).removeClass(b.disabledClass),F.is("button,input")&&F.prop("disabled",!1),G.is("button,input")&&G.prop("disabled",!1),c.cur<=c.min&&(F.addClass(b.disabledClass),F.is("button,input")&&F.prop("disabled",!0)),c.cur>=c.max&&(G.addClass(b.disabledClass),
G.is("button,input")&&G.prop("disabled",!0)))}function w(a,b){var c=a||window.event;c.preventDefault?c.preventDefault():c.returnValue=!1;b&&c.stopPropagation?c.stopPropagation():c.cancelBubble=!0}function Z(a,b){if(d.isFunction(b)&&d.isArray(q[a]))for(var c=0;c<q[a].length;c++)q[a][c]===b&&q[a].splice(c,1);else q[a]=[]}function P(a,b,c){if(d.isArray(q[a]))for(var f=0;f<q[a].length;f++)q[a][f].apply(b,c)}function U(a,b,c){if(d.isFunction(b))if(!1==c)Z(a,b);else a:{if(d.isFunction(b)){if(d.isArray(q[a])){if(-1!==
d.inArray(b,q[a]))break a}else q[a]=[];q[a].push(b)}}else!1==b&&Z(a)}function J(a){return!isNaN(parseFloat(a))&&isFinite(a)}var h=this,A=d(n),v=A.children().eq(0),o=0,i=0,c={cur:0,max:0,min:0},K=d(b.scrollBar),p=K.length?K.children().eq(0):0,O=0,H=0;k=0;t=0;L=0;var V=d(b.pagesBar),M=0,y=[],m=0,j=[],g={firstItem:0,lastItem:1,centerItem:1,activeItem:0,activePage:0,items:0,pages:0},$=b.scrollSource?d(b.scrollSource):A,B=d(b.prev),C=d(b.next),F=d(b.prevPage),G=d(b.nextPage),I=0,q={};this.reload=function(){o=
b.horizontal?A.width():A.height();O=b.horizontal?K.width():K.height();i=b.horizontal?v.outerWidth():v.outerHeight();m=v.children();j=[];y=[];c.min=0;c.max=i-o;g.items=m.length;if(b.byItems){var a=E(m,b.horizontal?"marginLeft":"marginTop"),u=a?E(m.slice(-1),b.horizontal?"marginRight":"marginBottom"):0,z=0,k=E(v,b.horizontal?"paddingLeft":"paddingTop"),w=E(v,b.horizontal?"paddingRight":"paddingBottom"),q="none"!=m.css("float");i=0;m.each(function(c,f){var g=d(f),h=b.horizontal?g.outerWidth(!0):g.outerHeight(!0),
r=E(g,"marginTop"),l=E(g,"marginBottom"),p=E(g,"marginLeft"),g=E(g,"marginRight");itemObj={size:h,offStart:i-(!c||b.horizontal?0:r),offCenter:i-Math.round(o/2-h/2),offEnd:i-o+h-(a?0:g),margins:{top:r,bottom:l,left:p,right:g}};c||(z=-(b.centerActive?Math.round(o/2-h/2):0)+k,i+=k);i+=h;!b.horizontal&&!q&&l&&r&&0<c&&(i-=r<l?r:l);c==m.length-1&&(i+=w+u);j.push(itemObj)});c.min=z;c.max=i-(b.centerActive?Math.round(o/2+j[j.length-1].size/2):o)-u;v.css(b.horizontal?{width:i+"px"}:{height:i+"px"});g.activeItem>=
j.length&&h.activate(j.length-1)}for(var D=0;D-o<=c.max;)y.push(D>c.max?c.max:D),D+=o;g.pages=y.length;d.extend(g,Q(c.cur));p&&(H=b.dynamicHandle?Math.round(O*o/i):b.horizontal?p.width():p.height(),H=H>O?O:H,t=O-H,p.css(b.horizontal?{width:H+"px"}:{height:H+"px"}));if(V.length&&!b.activeCenter){for(var D="",n=0;n<y.length;n++)D+=b.pageBuilder(n);M=d(D).bind("click."+f,function(){T(M.index(this))}).appendTo(V.empty())}m.unbind("."+f).bind("mouseup."+f+" sly:active."+f,function(a){!a.button&&!I&&h.activate(this)});
c.cur<c.min&&l(c.min);c.cur>c.max&&l(c.max);x(0);R();P("onLoad",A,[c,m,g])};this.prev=function(){h.activate(g.activeItem-1)};this.next=function(){h.activate(g.activeItem+1)};this.prevPage=function(){T(g.activePage-1)};this.nextPage=function(){T(g.activePage+1)};this.toStart=function(a){a=N(a);if(-1===a)l(c.min,null,1);else{if(b.centerActive)return;-1!==a&&l(j[a].offStart)}x()};this.toEnd=function(a){a=N(a);if(-1===a)l(c.max,null,1);else{if(b.centerActive)return;l(j[a].offEnd)}x()};this.toCenter=function(a){a=
N(a);l(-1===a?Math.round(c.max/2+c.min/2):j[a].offCenter,null,-1===a);x()};this.activate=function(a,c){if(b.byItems&&a!=X){var d=N(a),f=g.activeItem;g.activeItem=d;m.removeClass(b.activeClass).eq(d).addClass(b.activeClass);d!=f&&P("onActive",m.eq(g.activeItem),[m,g]);if(b.byItems&&!c&&(b.autoNav||b.centerActive))b.centerActive?h.toCenter(d):d>=g.lastItem?h.toStart(d):d<=g.firstItem&&h.toEnd(d);R()}};this.destroy=function(){n.add(document).add(v).add(m).add($).add(p).add(B).add(C).unbind("."+f);v.add(p).css(b.horizontal?
{left:0}:{top:0});B.add(C).removeClass(b.disabledClass);V.empty();d.removeData(e,W+f)};this.onMove=function(a,b){U("onMove",a,b)};this.onMoveEnd=function(a,b){U("onMoveEnd",a,b)};this.onActive=function(a,b){U("onActive",a,b)};(function(){"static"==A.css({overflow:"hidden"}).css("position")&&A.css({position:"relative"});"static"==K.css("position")&&K.css({position:"relative"});v.add(p).css(b.horizontal?{position:"absolute",left:0}:{position:"absolute",top:0});h.reload();b.byItems?h.activate(b.startAt):
l(c.cur-b.startAt);x();b.scrollBy&&$.bind("DOMMouseScroll."+f+" mousewheel."+f,function(a){w(a,1);var a=a.originalEvent,d=0;a.wheelDelta&&(d=a.wheelDelta/120);a.detail&&(d=-a.detail/3);a=0>d;b.byItems?(a=N((b.centerActive?g.centerItem:g.firstItem)+(a?b.scrollBy:-b.scrollBy)),b.centerActive?h.activate(a):l(j[a].offStart)):l(c.cur+(a?b.scrollBy:-b.scrollBy));x()});b.keyboardNav&&d(document).bind("keydown."+f,function(a){switch(a.keyCode||a.which){case s.horizontal?37:38:w(a);b.keyboardNavByPages?h.prevPage():
h.prev();break;case s.horizontal?39:40:w(a),b.keyboardNavByPages?h.nextPage():h.next()}});d(document).bind("keydown."+f,function(a){switch(a.keyCode||a.which){case 82:log(c,g,j,y)}});b.prev&&B.bind("click."+f,function(a){w(a);h.prev()});b.next&&C.bind("click."+f,function(a){w(a);h.next()});b.prevPage&&F.bind("click."+f,function(a){w(a);h.prevPage()});b.nextPage&&G.bind("click."+f,function(a){w(a);h.nextPage()});b.dragContent&&v.bind("mousedown."+f,function(a){if(!a.button){w(a);var g=a.clientX,h=
a.clientY,j=c.cur,k=+new Date,i=a.target||a.srcElement,p=d(document),m="mousemove."+f+" mouseup."+f,q=0;v.addClass(b.draggedClass);S();p.bind(m,function(a){var n="mouseup"==a.type,t=b.horizontal?a.clientX-g:a.clientY-h,r=j-t;r>c.max?r=c.max+(r-c.max)/6:r<c.min&&(r=c.min+(r-c.min)/6);if(n){p.unbind(m);v.removeClass(b.draggedClass);var o=+new Date-k,o=300>o?Math.ceil(Math.pow(6/(o/300),2)*Math.abs(t)/120):0,r=r+(0<t?-o:o)}q?(w(a),i&&(d(i).bind("click."+f,function ba(a){w(a,!0);d(this).unbind("click."+
f,ba)}),i=0),I=!n,l(r,n?b.speed:0,n),x(n?null:0)):q=10<Math.abs(t)})}});p&&b.dragHandle&&p.bind("mousedown."+f,function(a){if(!a.button){w(a);var g=a.clientX,h=a.clientY,j=k,i=-k,n=t-k,m=0,o=d(document),q="mousemove."+f+" mouseup."+f;p.addClass(b.draggedClass);S();o.bind(q,function(a){w(a);var d="mouseup"==a.type,a=b.horizontal?a.clientX-g:a.clientY-h,f=j+a,r=+new Date;I=!d;d&&(o.unbind(q),p.removeClass(b.draggedClass));if(a<n+5&&a>i-5||d){k=f>t?t:f<L?L:f;p.stop().css(b.horizontal?{left:k+"px"}:{top:k+
"px"});if(m<r||d||a>n||a<i)m=r+50,l(Math.round(k/t*(c.max-c.min))+c.min,d?b.speed:b.speed/4,d);Y()}})}})})()}var f="sly",W="plugin_";d.fn[f]=function(n){var b=!1,k=Array.prototype.slice.call(arguments,1),t={};d.isPlainObject(n)?t=d.extend({},d.fn[f].defaults,n):b=!1===n?"destroy":n;return this.each(function(n,l){var x=d.data(l,W+f)||d.data(l,W+f,new aa(l,t));d.isFunction(x[b])&&x[b].apply(x,k)})};d.fn[f].defaults={horizontal:0,byItems:0,autoNav:0,centerActive:0,scrollBar:null,dynamicHandle:1,dragHandle:1,
pagesBar:null,pageBuilder:function(d){return"<li>"+(d+1)+"</li>"},prev:null,next:null,prevPage:null,nextPage:null,scrollBy:0,dragContent:0,elasticBounds:0,speed:400,easing:"swing",scrollSource:null,startAt:0,keyboardNav:0,keyboardNavByPages:0,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}})(jQuery);
